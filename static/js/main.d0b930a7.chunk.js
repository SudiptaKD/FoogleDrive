(this["webpackJsonpfirebase-react-auth"]=this["webpackJsonpfirebase-react-auth"]||[]).push([[0],{86:function(e,t,r){"use strict";r.r(t);var c=r(0),a=r.n(c),n=r(26),s=r.n(n),i=r(23),l=r.n(i),o=r(31),d=r(10),j=r(101),u=r(92),b=r(96),h=r(93),O=r(14),p=r(61),x=(r(75),r(88),r(87),p.a.initializeApp({apiKey:"AIzaSyDAREI7G5CY3sXMEz5-mYtG_01wTcZYLQY",authDomain:"drive-auth-dev.firebaseapp.com",databaseURL:"",projectId:"drive-auth-dev",storageBucket:"drive-auth-dev.appspot.com",messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"/FoogleDrive",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDAREI7G5CY3sXMEz5-mYtG_01wTcZYLQY",REACT_APP_FIREBASE_APP_ID:"1:223234858610:web:d4d5884e1e05b55eff6ceb",REACT_APP_FIREBASE_AUTH_DOMAIN:"drive-auth-dev.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"",REACT_APP_FIREBASE_MESSaSING_SENDER_ID:"223234858610",REACT_APP_FIREBASE_PROJECT_ID:"drive-auth-dev",REACT_APP_FIREBASE_STORAGE_BUCKET:"drive-auth-dev.appspot.com"}).REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:"1:223234858610:web:d4d5884e1e05b55eff6ceb"})),f=x.firestore(),m={folders:f.collection("folders"),files:f.collection("files"),formatDoc:function(e){return Object(O.a)({id:e.id},e.data())},getCurrentTimestamp:p.a.firestore.FieldValue.serverTimestamp},v=x.storage(),g=x.auth(),w=r(2),y=a.a.createContext();function E(){return Object(c.useContext)(y)}function S(e){var t=e.children,r=Object(c.useState)(),a=Object(d.a)(r,2),n=a[0],s=a[1],i=Object(c.useState)(!0),l=Object(d.a)(i,2),o=l[0],j=l[1];Object(c.useEffect)((function(){return g.onAuthStateChanged((function(e){s(e),j(!1)}))}),[]);var u={currentUser:n,login:function(e,t){return g.signInWithEmailAndPassword(e,t)},signup:function(e,t){return g.createUserWithEmailAndPassword(e,t)},logout:function(){return g.signOut()},resetPassword:function(e){return g.sendPasswordResetEmail(e)},updateEmail:function(e){return n.updateEmail(e)},updatePassword:function(e){return n.updatePassword(e)}};return Object(w.jsx)(y.Provider,{value:u,children:!o&&t})}var P=r(13),A=r(11),I=r(91);function _(e){var t=e.children;return Object(w.jsx)(I.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(w.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:t})})}function R(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),a=E().signup,n=Object(c.useState)(""),s=Object(d.a)(n,2),i=s[0],O=s[1],p=Object(c.useState)(!1),x=Object(d.a)(p,2),f=x[0],m=x[1],v=Object(P.g)();function g(){return(g=Object(o.a)(l.a.mark((function c(n){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(n.preventDefault(),t.current.value===r.current.value){c.next=3;break}return c.abrupt("return",O("Passwords do not match"));case 3:return c.prev=3,O(""),m(!0),c.next=8,a(e.current.value,t.current.value);case 8:v.push("/"),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(3),O("Failed to create an account");case 14:m(!1);case 15:case"end":return c.stop()}}),c,null,[[3,11]])})))).apply(this,arguments)}return Object(w.jsxs)(_,{children:[Object(w.jsx)(j.a,{children:Object(w.jsxs)(j.a.Body,{children:[Object(w.jsx)("h2",{className:"text-center mb-4",children:"Sign Up"}),i&&Object(w.jsx)(u.a,{variant:"danger",children:i}),Object(w.jsxs)(b.a,{onSubmit:function(e){return g.apply(this,arguments)},children:[Object(w.jsxs)(b.a.Group,{id:"email",children:[Object(w.jsx)(b.a.Label,{children:"Email"}),Object(w.jsx)(b.a.Control,{type:"email",ref:e,required:!0})]}),Object(w.jsxs)(b.a.Group,{id:"password",children:[Object(w.jsx)(b.a.Label,{children:"Password"}),Object(w.jsx)(b.a.Control,{type:"password",ref:t,required:!0})]}),Object(w.jsxs)(b.a.Group,{id:"password-confirm",children:[Object(w.jsx)(b.a.Label,{children:"Password Confirmation"}),Object(w.jsx)(b.a.Control,{type:"password",ref:r,required:!0})]}),Object(w.jsx)(h.a,{disabled:f,className:"w-100",type:"submit",children:"Sign Up"})]})]})}),Object(w.jsxs)("div",{className:"w-100 text-center mt-2",children:["Already have an account? ",Object(w.jsx)(A.b,{to:"/login",children:"Log In"})]})]})}function C(){var e=Object(c.useState)(""),t=Object(d.a)(e,2),r=t[0],a=t[1],n=E(),s=n.currentUser,i=n.logout,b=Object(P.g)();function O(){return(O=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(""),e.prev=1,e.next=4,i();case 4:b.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a("Failed to log out");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}return Object(w.jsxs)(_,{children:[Object(w.jsx)(j.a,{children:Object(w.jsxs)(j.a.Body,{children:[Object(w.jsx)("h2",{className:"text-center mb-4",children:"Profile"}),r&&Object(w.jsx)(u.a,{variant:"danger",children:r}),Object(w.jsx)("strong",{children:"Email:"})," ",s.email,Object(w.jsx)(A.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3",children:"Update Profile"})]})}),Object(w.jsx)("div",{className:"w-100 text-center mt-2",children:Object(w.jsx)(h.a,{variant:"link",onClick:function(){return O.apply(this,arguments)},children:"Log Out"})})]})}function F(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=E().login,a=Object(c.useState)(""),n=Object(d.a)(a,2),s=n[0],i=n[1],O=Object(c.useState)(!1),p=Object(d.a)(O,2),x=p[0],f=p[1],m=Object(P.g)();function v(){return(v=Object(o.a)(l.a.mark((function c(a){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return a.preventDefault(),c.prev=1,i(""),f(!0),c.next=6,r(e.current.value,t.current.value);case 6:m.push("/"),c.next=12;break;case 9:c.prev=9,c.t0=c.catch(1),i("Failed to log in");case 12:f(!1);case 13:case"end":return c.stop()}}),c,null,[[1,9]])})))).apply(this,arguments)}return Object(w.jsxs)(_,{children:[Object(w.jsx)(j.a,{children:Object(w.jsxs)(j.a.Body,{children:[Object(w.jsx)("h2",{className:"text-center mb-4",children:"Log In"}),s&&Object(w.jsx)(u.a,{variant:"danger",children:s}),Object(w.jsxs)(b.a,{onSubmit:function(e){return v.apply(this,arguments)},children:[Object(w.jsxs)(b.a.Group,{id:"email",children:[Object(w.jsx)(b.a.Label,{children:"Email"}),Object(w.jsx)(b.a.Control,{type:"email",ref:e,required:!0})]}),Object(w.jsxs)(b.a.Group,{id:"password",children:[Object(w.jsx)(b.a.Label,{children:"Password"}),Object(w.jsx)(b.a.Control,{type:"password",ref:t,required:!0})]}),Object(w.jsx)(h.a,{disabled:x,className:"w-100",type:"submit",children:"Log In"})]}),Object(w.jsx)("div",{className:"w-100 text-center mt-3",children:Object(w.jsx)(A.b,{to:"/forgot-password",children:"Forgot Password?"})})]})}),Object(w.jsxs)("div",{className:"w-100 text-center mt-2",children:["Need an account? ",Object(w.jsx)(A.b,{to:"/signup",children:"Sign Up"})]})]})}var N=r(69),k=["component"];function T(e){var t=e.component,r=Object(N.a)(e,k),c=E().currentUser;return Object(w.jsx)(P.b,Object(O.a)(Object(O.a)({},r),{},{render:function(e){return c?Object(w.jsx)(t,Object(O.a)({},e)):Object(w.jsx)(P.a,{to:"/login"})}}))}function D(){var e=Object(c.useRef)(),t=E().resetPassword,r=Object(c.useState)(""),a=Object(d.a)(r,2),n=a[0],s=a[1],i=Object(c.useState)(""),O=Object(d.a)(i,2),p=O[0],x=O[1],f=Object(c.useState)(!1),m=Object(d.a)(f,2),v=m[0],g=m[1];function y(){return(y=Object(o.a)(l.a.mark((function r(c){return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c.preventDefault(),r.prev=1,x(""),s(""),g(!0),r.next=7,t(e.current.value);case 7:x("Check your inbox for further instructions"),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1),s("Failed to reset password");case 13:g(!1);case 14:case"end":return r.stop()}}),r,null,[[1,10]])})))).apply(this,arguments)}return Object(w.jsxs)(_,{children:[Object(w.jsx)(j.a,{children:Object(w.jsxs)(j.a.Body,{children:[Object(w.jsx)("h2",{className:"text-center mb-4",children:"Password Reset"}),n&&Object(w.jsx)(u.a,{variant:"danger",children:n}),p&&Object(w.jsx)(u.a,{variant:"success",children:p}),Object(w.jsxs)(b.a,{onSubmit:function(e){return y.apply(this,arguments)},children:[Object(w.jsxs)(b.a.Group,{id:"email",children:[Object(w.jsx)(b.a.Label,{children:"Email"}),Object(w.jsx)(b.a.Control,{type:"email",ref:e,required:!0})]}),Object(w.jsx)(h.a,{disabled:v,className:"w-100",type:"submit",children:"Reset Password"})]}),Object(w.jsx)("div",{className:"w-100 text-center mt-3",children:Object(w.jsx)(A.b,{to:"/login",children:"Login"})})]})}),Object(w.jsxs)("div",{className:"w-100 text-center mt-2",children:["Need an account? ",Object(w.jsx)(A.b,{to:"/signup",children:"Sign Up"})]})]})}function L(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),a=E(),n=a.currentUser,s=a.updatePassword,i=a.updateEmail,l=Object(c.useState)(""),o=Object(d.a)(l,2),O=o[0],p=o[1],x=Object(c.useState)(!1),f=Object(d.a)(x,2),m=f[0],v=f[1],g=Object(P.g)();return Object(w.jsxs)(_,{children:[Object(w.jsx)(j.a,{children:Object(w.jsxs)(j.a.Body,{children:[Object(w.jsx)("h2",{className:"text-center mb-4",children:"Update Profile"}),O&&Object(w.jsx)(u.a,{variant:"danger",children:O}),Object(w.jsxs)(b.a,{onSubmit:function(c){if(c.preventDefault(),t.current.value!==r.current.value)return p("Passwords do not match");var a=[];v(!0),p(""),e.current.value!==n.email&&a.push(i(e.current.value)),t.current.value&&a.push(s(t.current.value)),Promise.all(a).then((function(){g.push("/user")})).catch((function(){p("Failed to update account")})).finally((function(){v(!1)}))},children:[Object(w.jsxs)(b.a.Group,{id:"email",children:[Object(w.jsx)(b.a.Label,{children:"Email"}),Object(w.jsx)(b.a.Control,{type:"email",ref:e,required:!0,defaultValue:n.email})]}),Object(w.jsxs)(b.a.Group,{id:"password",children:[Object(w.jsx)(b.a.Label,{children:"Password"}),Object(w.jsx)(b.a.Control,{type:"password",ref:t,placeholder:"Leave blank to keep the same"})]}),Object(w.jsxs)(b.a.Group,{id:"password-confirm",children:[Object(w.jsx)(b.a.Label,{children:"Password Confirmation"}),Object(w.jsx)(b.a.Control,{type:"password",ref:r,placeholder:"Leave blank to keep the same"})]}),Object(w.jsx)(h.a,{disabled:m,className:"w-100",type:"submit",children:"Update"})]})]})}),Object(w.jsx)("div",{className:"w-100 text-center mt-2",children:Object(w.jsx)(A.b,{to:"/user",children:"Cancel"})})]})}var B=r(94),U=r(68),G="select-folder",W="update-folder",Y="set-child-folders",q="set-child-files",H={name:"Root",id:null,path:[]};function M(e,t){var r=t.type,c=t.payload;switch(r){case G:return{folderId:c.folderId,folder:c.folder,childFiles:[],childFolders:[]};case W:return Object(O.a)(Object(O.a)({},e),{},{folder:c.folder});case Y:return Object(O.a)(Object(O.a)({},e),{},{childFolders:c.childFolders});case q:return Object(O.a)(Object(O.a)({},e),{},{childFiles:c.childFiles});default:return e}}var z=r(41),K=r(95),J=r(34),V=r(35);function Q(e){var t=e.currentFolder,r=Object(c.useState)(!1),a=Object(d.a)(r,2),n=a[0],s=a[1],i=Object(c.useState)(""),l=Object(d.a)(i,2),o=l[0],j=l[1],u=E().currentUser;function O(){s(!1)}return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(h.a,{onClick:function(){s(!0)},variant:"outline-success",size:"lg",children:Object(w.jsx)(J.a,{icon:V.d})}),Object(w.jsx)(K.a,{show:n,onHide:O,children:Object(w.jsxs)(b.a,{onSubmit:function(e){if(e.preventDefault(),null!=t){var r=Object(z.a)(t.path);t!==H&&r.push({name:t.name,id:t.id}),m.folders.add({name:o,parentId:t.id,userId:u.uid,path:r,createdAt:m.getCurrentTimestamp()}),j(""),O()}},children:[Object(w.jsx)(K.a.Body,{children:Object(w.jsxs)(b.a.Group,{children:[Object(w.jsx)(b.a.Label,{children:"Folder Name"}),Object(w.jsx)(b.a.Control,{type:"text",required:!0,value:o,onChange:function(e){return j(e.target.value)}})]})}),Object(w.jsxs)(K.a.Footer,{children:[Object(w.jsx)(h.a,{variant:"secondary",onClick:O,children:"Close"}),Object(w.jsx)(h.a,{variant:"success",type:"submit",children:"Add Folder"})]})]})})]})}var X=r(100),Z=r(98),$=r(102);function ee(e){var t=e.currentFolder,r=Object(c.useState)([]),a=Object(d.a)(r,2),n=a[0],i=a[1],l=E().currentUser;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("label",{className:"btn btn-outline-success btn-lg m-0 ",children:[Object(w.jsx)(J.a,{icon:V.b}),Object(w.jsx)("input",{type:"file",onChange:function(e){var r=e.target.files[0];if(null!=t&&null!=r){var c=Object(X.a)();i((function(e){return[].concat(Object(z.a)(e),[{id:c,name:r.name,progress:0,error:!1}])}));var a=t===H?"".concat(t.path.join("/"),"/").concat(r.name):"".concat(t.path.join("/"),"/").concat(t.name,"/").concat(r.name),n=v.ref("/files/".concat(l.uid,"/").concat(a)).put(r);n.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes;i((function(e){return e.map((function(e){return e.id===c?Object(O.a)(Object(O.a)({},e),{},{progress:t}):e}))}))}),(function(){i((function(e){return e.map((function(e){return e.id===c?Object(O.a)(Object(O.a)({},e),{},{error:!0}):e}))}))}),(function(){i((function(e){return e.filter((function(e){return e.id!==c}))})),n.snapshot.ref.getDownloadURL().then((function(e){m.files.where("name","==",r.name).where("userId","==",l.uid).where("folderId","==",t.id).get().then((function(c){var a=c.docs[0];a?a.ref.update({url:e}):m.files.add({url:e,name:r.name,createdAt:m.getCurrentTimestamp(),folderId:t.id,userId:l.uid})}))}))}))}},style:{opacity:0,position:"absolute",left:"-9999px"}})]}),n.length>0&&s.a.createPortal(Object(w.jsx)("div",{style:{position:"absolute",bottom:"1rem",right:"1rem",maxWidth:"250px"},children:n.map((function(e){return Object(w.jsxs)(Z.a,{onClose:function(){i((function(t){return t.filter((function(t){return t.id!==e.id}))}))},children:[Object(w.jsx)(Z.a.Header,{closeButton:e.error,className:"text-truncate w-100 d-block",children:e.name}),Object(w.jsx)(Z.a.Body,{children:Object(w.jsx)($.a,{animated:!e.error,variant:e.error?"danger":"primary",now:e.error?100:100*e.progress,label:e.error?"Error":"".concat(Math.round(100*e.progress),"%")})})]},e.id)}))}),document.body)]})}function te(e){var t=e.folder;return Object(w.jsxs)(h.a,{to:{pathname:"/folder/".concat(t.id),state:{folder:t}},variant:"outline-primary",className:"text-truncate w-100",as:A.b,children:[Object(w.jsx)(J.a,{icon:V.c,style:{marginRight:"10px"}}),t.name]})}function re(e){var t=e.file;return Object(w.jsxs)("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"btn btn-outline-dark text-truncate w-100",children:[Object(w.jsx)(J.a,{icon:V.a,style:{marginRight:"10px"}}),t.name]})}var ce=r(99),ae=r(97),ne=r.p+"static/media/google drive.svg.bba8aadf.png";function se(){return Object(w.jsx)(ce.a,{bg:"secondary",variant:"dark",expand:"sm",children:Object(w.jsxs)(B.a,{style:{marginLeft:"20px",width:"100%"},children:[Object(w.jsxs)(U.a,{xl:10,lg:10,md:10,sm:9,xs:8,children:[Object(w.jsx)(ce.a.Brand,{as:A.b,to:"/",children:Object(w.jsx)("img",{src:ne,width:"30",height:"30",alt:"logo"})}),Object(w.jsx)(ce.a.Brand,{as:A.b,to:"/",children:"Foogle Drive"})]}),Object(w.jsx)(U.a,{xl:2,lg:2,md:2,sm:3,xs:4,children:Object(w.jsx)(ae.a,{style:{marginRight:"20px"},children:Object(w.jsx)(ae.a.Link,{as:A.b,to:"/user",children:"Profile"})})})]})})}var ie=r(103);function le(e){var t=e.currentFolder,r=t===H?[]:[H];return t&&(r=[].concat(Object(z.a)(r),Object(z.a)(t.path))),Object(w.jsxs)(ie.a,{className:"flex-grow-1",listProps:{className:"bg-white pl-0 m-0"},children:[r.map((function(e,t){return Object(w.jsx)(ie.a.Item,{linkAs:A.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(O.a)(Object(O.a)({},e),{},{path:r.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:e.name},e.id)})),t&&Object(w.jsx)(ie.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0,children:t.name})]})}function oe(){var e=Object(P.i)().folderId,t=Object(P.h)().state,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=Object(c.useReducer)(M,{folderId:e,folder:t,childFolders:[],childFiles:[]}),a=Object(d.a)(r,2),n=a[0],s=a[1],i=E().currentUser;return Object(c.useEffect)((function(){s({type:G,payload:{folderId:e,folder:t}})}),[e,t]),Object(c.useEffect)((function(){if(null==e)return s({type:W,payload:{folder:H}});m.folders.doc(e).get().then((function(e){s({type:W,payload:{folder:m.formatDoc(e)}})})).catch((function(){s({type:W,payload:{folder:H}})}))}),[e]),Object(c.useEffect)((function(){return m.folders.where("parentId","==",e).where("userId","==",i.uid).orderBy("createdAt").onSnapshot((function(e){s({type:Y,payload:{childFolders:e.docs.map(m.formatDoc)}})}))}),[e,i]),Object(c.useEffect)((function(){return m.files.where("folderId","==",e).where("userId","==",i.uid).onSnapshot((function(e){s({type:q,payload:{childFiles:e.docs.map(m.formatDoc)}})}))}),[e,i]),n}(e,(void 0===t?{}:t).folder),a=r.folder,n=r.childFolders,s=r.childFiles;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(se,{}),Object(w.jsxs)(I.a,{fluid:!0,children:[Object(w.jsxs)(B.a,{style:{marginTop:"20px"},children:[Object(w.jsx)(U.a,{xl:10,lg:10,md:8,sm:8,xs:8,children:Object(w.jsx)(le,{currentFolder:a})}),Object(w.jsx)(U.a,{xl:1,lg:1,md:2,sm:2,xs:2,children:Object(w.jsx)(ee,{currentFolder:a})}),Object(w.jsx)(U.a,{xl:1,lg:1,md:2,sm:2,xs:2,children:Object(w.jsx)(Q,{currentFolder:a})})]}),Object(w.jsx)("hr",{}),n.length>0&&Object(w.jsx)("div",{className:"d-flex flex-wrap",children:n.map((function(e){return Object(w.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(w.jsx)(te,{folder:e})},e.id)}))}),n.length>0&&s.length>0&&Object(w.jsx)("hr",{}),s.length>0&&Object(w.jsx)("div",{className:"d-flex flex-wrap",children:s.map((function(e){return Object(w.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(w.jsx)(re,{file:e})},e.id)}))})]})]})}var de=function(){return Object(w.jsx)(A.a,{children:Object(w.jsx)(S,{children:Object(w.jsxs)(P.d,{children:[Object(w.jsx)(T,{exact:!0,path:"/",component:oe}),Object(w.jsx)(T,{exact:!0,path:"/folder/:folderId",component:oe}),Object(w.jsx)(T,{path:"/user",component:C}),Object(w.jsx)(T,{path:"/update-profile",component:L}),Object(w.jsx)(P.b,{path:"/signup",component:R}),Object(w.jsx)(P.b,{path:"/login",component:F}),Object(w.jsx)(P.b,{path:"/forgot-password",component:D})]})})})};r(85);s.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(de,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.d0b930a7.chunk.js.map